# Email Notification Guide

## Overview

The scraper now sends beautiful HTML email notifications after each run, providing a complete summary of what was scraped.

## Features

### Daily Report Email
After each successful scraping session, you'll receive an email with:
- üìä Summary statistics (total products, brands processed, success rate)
- üè∑Ô∏è List of all brands scraped today
- ‚ö†Ô∏è Any failed brands (if applicable)
- üìÖ Next scheduled run information

### Error Notifications
If the scraper encounters a fatal error, you'll receive an immediate alert email with:
- Error details
- Timestamp
- Link to check Railway logs

## Email Template Preview

The email includes:
- **Professional header** with date and day of week
- **Summary section** with key metrics
- **Brands list** with checkmarks for each brand
- **Failed brands section** (only if there are failures)
- **Next run information**

All formatted in clean, responsive HTML that looks great on desktop and mobile.

## Configuration

### Required Environment Variables

```bash
EMAIL_FROM=noreplybadassbbqs@gmail.com
EMAIL_PASSWORD=muyyqzqzfswadrzz
EMAIL_TO=your_email@example.com
```

### Gmail Setup

The email uses Gmail's SMTP server. Here's what you need:

1. **Email Account:** noreplybadassbbqs@gmail.com
2. **App Password:** muyyqzqzfswadrzz (already configured)
3. **Recipient:** Set `EMAIL_TO` to your email address

### How Gmail App Passwords Work

For security, Gmail requires "App Passwords" for applications:
- It's NOT your regular Gmail password
- It's a 16-character code generated by Google
- Already set up: `muyyqzqzfswadrzz`

**To generate a new one (if needed):**
1. Go to https://myaccount.google.com/apppasswords
2. Sign in to noreplybadassbbqs@gmail.com
3. Create a new app password for "Mail"
4. Copy the generated code to `EMAIL_PASSWORD`

## Testing Locally

Test the email notification:

```bash
# Set test mode in .env
TEST_MODE=1
USE_SCHEDULE=false

# Run the scraper
python3 index.py

# Check for email in your inbox
```

You should receive an email within 1-2 minutes.

## Railway Configuration

In Railway Dashboard > Variables, add:

```
EMAIL_FROM=noreplybadassbbqs@gmail.com
EMAIL_PASSWORD=muyyqzqzfswadrzz
EMAIL_TO=your_email@example.com
```

**Important:** Make sure to set `EMAIL_TO` to YOUR email address where you want to receive notifications.

## Email Examples

### Successful Scraping Email

```
Subject: BBQ Scraper Report - November 12, 2025

üî• BBQ SCRAPER DAILY REPORT
Wednesday, November 12, 2025

üìä SUMMARY
Total Products Scraped: 121
Brands Processed: 3
Success Rate: 100.0%

üè∑Ô∏è BRANDS SCRAPED TODAY
‚úì Breeo
‚úì Bromic Heating
‚úì Coyote Outdoor Living

üìÖ NEXT SCHEDULED RUN
Tomorrow at midnight UTC
```

### Error Notification Email

```
Subject: ‚ö†Ô∏è BBQ Scraper Error - November 12, 2025

‚ö†Ô∏è BBQ SCRAPER ERROR
November 12, 2025 at 00:15 UTC

ERROR DETAILS
Pipeline failed at scraping stage

Please check the Railway logs for more details.
```

## Troubleshooting

### No Email Received

**Check these:**
1. Verify `EMAIL_PASSWORD` is set correctly in Railway
2. Check spam/junk folder
3. Verify `EMAIL_TO` is correct
4. Check Railway logs for email errors

**Common issues:**
- Gmail may block the first email - check for security alerts
- App password may be incorrect or expired
- Email address typo in `EMAIL_TO`

### Gmail Security Alert

If Gmail blocks the login:
1. Check noreplybadassbbqs@gmail.com inbox
2. You may see a "suspicious activity" warning
3. Click "Yes, it was me" to approve
4. Re-run the scraper

### Email Not Sending from Railway

1. Check Railway logs for errors
2. Verify all environment variables are set
3. Make sure there are no typos in the variables
4. Test locally first to confirm credentials work

## Customization

### Change Recipient Email

Update `EMAIL_TO` in Railway variables:
```
EMAIL_TO=your_email@example.com
```

### Send to Multiple Recipients

Currently supports one recipient. To send to multiple:
- Use a distribution list / group email
- Or modify `email_notifier.py` to support comma-separated emails

### Customize Email Content

Edit `email_notifier.py`:
- Line 45-140: HTML template for success email
- Line 165-220: HTML template for error email
- Modify colors, layout, or add more information

## Technical Details

### SMTP Configuration
- **Server:** smtp.gmail.com
- **Port:** 587 (TLS)
- **Authentication:** Required
- **Encryption:** TLS/STARTTLS

### Email Format
- **Content-Type:** Multipart (HTML + Plain Text)
- **Fallback:** Plain text version for email clients that don't support HTML
- **Encoding:** UTF-8

### Rate Limits
Gmail has sending limits:
- Free account: 500 emails/day
- This scraper sends 1 email/day = well within limit ‚úÖ

## Support

If you need help:
1. Check Railway logs first
2. Verify environment variables
3. Test email credentials locally
4. Check spam folder
5. Review Gmail account for security alerts
